{"ast":null,"code":"var _jsxFileName = \"/Users/Kirti.Kaushal/Documents/poc-msal-with-react-power-bi/SPA/src/pages/Hello.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { MsalAuthenticationTemplate, useMsal, useAccount } from \"@azure/msal-react\";\nimport { InteractionRequiredAuthError, InteractionType } from \"@azure/msal-browser\";\nimport { loginRequest, protectedResources } from \"../authConfig\";\nimport { callApiWithToken } from \"../fetch\";\nimport { HelloData } from \"../components/DataDisplay\";\nimport Reports from './Reports';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst HelloContent = () => {\n  _s();\n\n  /**\n   * useMsal is hook that returns the PublicClientApplication instance, \n   * an array of all accounts currently signed in and an inProgress value \n   * that tells you what msal is currently doing. For more, visit: \n   * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-react/docs/hooks.md\n   */\n  const {\n    instance,\n    accounts,\n    inProgress\n  } = useMsal();\n  const account = useAccount(accounts[0] || {});\n  const [helloData, setHelloData] = useState(null);\n  useEffect(() => {\n    if (account && inProgress === \"none\" && !helloData) {\n      instance.acquireTokenSilent({\n        scopes: protectedResources.apiHello.scopes,\n        account: account\n      }).then(response => {\n        console.log(response, 'response');\n        callApiWithToken(response.access_token, protectedResources.apiHello.endpoint).then(response => setHelloData(response));\n      }).catch(error => {\n        // in case if silent token acquisition fails, fallback to an interactive method\n        if (error instanceof InteractionRequiredAuthError) {\n          if (account && inProgress === \"none\") {\n            instance.acquireTokenPopup({\n              scopes: protectedResources.apiHello.scopes\n            }).then(response => {\n              callApiWithToken(response.accessToken, protectedResources.apiHello.endpoint).then(response => setHelloData(response));\n            }).catch(error => console.log(error));\n          }\n        }\n      });\n    }\n  }, [account, inProgress, instance]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [helloData ? /*#__PURE__*/_jsxDEV(HelloData, {\n      helloData: helloData\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 27\n    }, this) : null, /*#__PURE__*/_jsxDEV(Reports, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n/**\n * The `MsalAuthenticationTemplate` component will render its children if a user is authenticated \n * or attempt to sign a user in. Just provide it with the interaction type you would like to use \n * (redirect or popup) and optionally a [request object](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/request-response-object.md)\n * to be passed to the login API, a component to display while authentication is in progress or a component to display if an error occurs. For more, visit:\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-react/docs/getting-started.md\n */\n\n\n_s(HelloContent, \"a53SmMZ5G8BSbJ2OemZf3yTVlig=\", false, function () {\n  return [useMsal, useAccount];\n});\n\n_c = HelloContent;\nexport const Hello = () => {\n  const authRequest = { ...loginRequest\n  };\n  return /*#__PURE__*/_jsxDEV(MsalAuthenticationTemplate, {\n    interactionType: InteractionType.Redirect,\n    authenticationRequest: authRequest,\n    children: /*#__PURE__*/_jsxDEV(HelloContent, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 9\n  }, this);\n};\n_c2 = Hello;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"HelloContent\");\n$RefreshReg$(_c2, \"Hello\");","map":{"version":3,"sources":["/Users/Kirti.Kaushal/Documents/poc-msal-with-react-power-bi/SPA/src/pages/Hello.jsx"],"names":["useEffect","useState","MsalAuthenticationTemplate","useMsal","useAccount","InteractionRequiredAuthError","InteractionType","loginRequest","protectedResources","callApiWithToken","HelloData","Reports","HelloContent","instance","accounts","inProgress","account","helloData","setHelloData","acquireTokenSilent","scopes","apiHello","then","response","console","log","access_token","endpoint","catch","error","acquireTokenPopup","accessToken","Hello","authRequest","Redirect"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\n\nimport { MsalAuthenticationTemplate, useMsal, useAccount } from \"@azure/msal-react\";\nimport { InteractionRequiredAuthError, InteractionType } from \"@azure/msal-browser\";\n\nimport { loginRequest, protectedResources } from \"../authConfig\";\nimport { callApiWithToken } from \"../fetch\";\nimport { HelloData } from \"../components/DataDisplay\";\nimport Reports from './Reports'\n\nconst HelloContent = () => {\n    /**\n     * useMsal is hook that returns the PublicClientApplication instance, \n     * an array of all accounts currently signed in and an inProgress value \n     * that tells you what msal is currently doing. For more, visit: \n     * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-react/docs/hooks.md\n     */\n    const { instance, accounts, inProgress } = useMsal();\n    const account = useAccount(accounts[0] || {});\n    const [helloData, setHelloData] = useState(null);\n\n    useEffect(() => {\n        if (account && inProgress === \"none\" && !helloData) {\n            instance.acquireTokenSilent({\n                scopes: protectedResources.apiHello.scopes,\n                account: account\n            }).then((response) => {\n                console.log(response,'response')\n                callApiWithToken(response.access_token, protectedResources.apiHello.endpoint)\n                    .then(response => setHelloData(response));\n            }).catch((error) => {\n                // in case if silent token acquisition fails, fallback to an interactive method\n                if (error instanceof InteractionRequiredAuthError) {\n                    if (account && inProgress === \"none\") {\n                        instance.acquireTokenPopup({\n                            scopes: protectedResources.apiHello.scopes,\n                        }).then((response) => {\n                            callApiWithToken(response.accessToken, protectedResources.apiHello.endpoint)\n                                .then(response => setHelloData(response));\n                        }).catch(error => console.log(error));\n                    }\n                }\n            });\n        }\n    }, [account, inProgress, instance]);\n  \n    return (\n        <>\n            { helloData ? <HelloData helloData={helloData} /> : null }\n            <Reports/>\n        </>\n    );\n};\n\n/**\n * The `MsalAuthenticationTemplate` component will render its children if a user is authenticated \n * or attempt to sign a user in. Just provide it with the interaction type you would like to use \n * (redirect or popup) and optionally a [request object](https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/request-response-object.md)\n * to be passed to the login API, a component to display while authentication is in progress or a component to display if an error occurs. For more, visit:\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-react/docs/getting-started.md\n */\nexport const Hello = () => {\n    const authRequest = {\n        ...loginRequest\n    };\n\n    return (\n        <MsalAuthenticationTemplate \n            interactionType={InteractionType.Redirect} \n            authenticationRequest={authRequest}\n        >\n            <HelloContent />\n        </MsalAuthenticationTemplate>\n      )\n};"]},"metadata":{},"sourceType":"module"}